{"version":3,"sources":["components/MapboxLayer.js","components/functions/flattenGeoJson.js","components/functions/randomColor.js","components/functions/capitalize.js","components/searchResult.jsx","components/MapUI.jsx","components/Map.jsx","App.js","index.js"],"names":["MapBoxGLLayer","props","L","mapboxGL","GridLayer","propTypes","accessToken","PropTypes","string","isRequired","style","defaultProps","withLeaflet","polygonIndex","getRandomColor","color","i","Math","floor","random","capitalize","s","charAt","toUpperCase","slice","SearchResult","handleClick","e","returnResult","target","state","Fragment","this","searchResults","map","elem","className","value","place_id","onClick","key","display_name","type","lat","lon","React","Component","geojsonHeader","name","properties","geometry","coordinates","flattenGeoJson","polygon","geojson","split","MapUI","handleSearchResultClick","resultValue","getAttribute","selectedCityResult","filter","ex","parseInt","addOutline","handleSearch","length","axios","get","then","res","cityResults","data","el","setState","setFocus","focused","toggleUI","focusInput","searchStyle","refs","searchbar","focus","onkeypress","charCode","keyCode","preventDefault","onChange","collapseSearch","onMouseEnter","onMouseLeave","id","ref","placeholder","onBlur","onFocus","MapView","setCity","city","addCityLayer","outline","mapInst","leafletElement","boundaryColor","trueSize","markerDiv","iconAnchor","fill","fillColor","fillOpacity","weight","opacity","stroke","addTo","console","log","latlng","lng","zoom","selectedCity","position","center","zoomSnap","MapboxLayer","App","ReactDOM","render","document","getElementById"],"mappings":"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","file":"static/js/main.b81f9aee.chunk.js","sourcesContent":["import L from \"leaflet\";\nimport {} from \"mapbox-gl-leaflet\";\nimport PropTypes from \"prop-types\";\nimport { GridLayer, withLeaflet } from \"react-leaflet\";\n\nclass MapBoxGLLayer extends GridLayer {\n  createLeafletElement(props) {\n    return L.mapboxGL(props);\n  }\n}\n\n/*\n* Props are the options supported by Mapbox Map object\n* Find options here:https://www.mapbox.com/mapbox-gl-js/api/#new-mapboxgl-map-options-\n*/\nMapBoxGLLayer.propTypes = {\n  accessToken: PropTypes.string.isRequired,\n  style: PropTypes.string\n};\n\nMapBoxGLLayer.defaultProps = {\n  style: \"mapbox://styles/mapbox/streets-v9\"\n};\n\nexport default withLeaflet(MapBoxGLLayer);\n","let geojsonHeader = {\n  type: \"Feature\",\n  name: \"\",\n  properties: {},\n  geometry: {\n    type: \"Polygon\",\n    coordinates: [\n      [\n\n      ]\n    ]\n  }\n};\n\nlet polygonIndex;\n\nconst flattenGeoJson = (polygon) => {\n  // MultiPolygons GeoJSONs have another layer of depth so\n  // this changes polygonIndex to the appriate array depth.\n  if (polygon[0].geojson.type === 'MultiPolygon') {\n    polygonIndex = polygon[0].geojson.coordinates[0][0];\n  } else if (polygon[0].geojson.type === 'Polygon') {\n    polygonIndex = polygon[0].geojson.coordinates[0];\n  }\n  geojsonHeader.geometry.coordinates[0] = polygonIndex;\n  geojsonHeader.name = polygon[0].display_name.split(',')[0];\n\n  return(geojsonHeader);\n}\n\nexport default flattenGeoJson;\n\n\n","const getRandomColor = () => {\n  let letters = '0123456789ABCDEF';\n  var color = '#';\n  for (let i = 0; i < 6; i++) {\n    color += letters[Math.floor(Math.random() * 16)];\n  }\n  let outline = color;\n  return [color, outline];\n};\n\nexport default getRandomColor;\n","const capitalize = (s) => {\n  if (typeof s !== 'string') return ''\n  return s.charAt(0).toUpperCase() + s.slice(1)\n}\n\nexport default capitalize;\n","import React from 'react';\nimport capitalize from './functions/capitalize.js';\n\nexport default class SearchResult extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n    };\n  }\n\n  handleClick = (e) => {\n    this.props.returnResult(e.target);\n  }\n\n  render() {\n    return (\n      <React.Fragment>\n        {this.props.searchResults.map(elem => (\n          <div\n            className={\"searchResult\"}\n            value={elem.place_id}\n            onClick={this.handleClick}\n            key={elem.place_id}>\n            <h4>{elem.display_name}</h4>\n            <p>Border Type: {capitalize(elem.type)}</p>\n            <p>{elem.lat}</p>\n            <p>{elem.lon}</p>\n          </div>\n        ))}\n      </React.Fragment>\n    );\n  }\n}\n\n\n","import React from \"react\";\nimport SearchResult from \"./searchResult.jsx\";\n//import outlines from \"./outlines/outlines.js\";\nimport axios from \"axios\";\nimport flattenGeoJson from \"./functions/flattenGeoJson.js\";\n\nexport default class MapUI extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      searchResults: [],\n      searchStyle: {'display': 'block'},\n      focused: true,\n      style: {}\n    };\n  }\n\n  handleSearchResultClick = e => {\n    let resultValue = e.getAttribute(\"value\"); //select matching search result based on value element in result html attribute\n    let selectedCityResult = this.state.searchResults.filter(function(ex) {\n      return ex.place_id === parseInt(resultValue);\n    });\n    flattenGeoJson(selectedCityResult);\n\n    this.props.addOutline(flattenGeoJson(selectedCityResult));\n  };\n\n  handleSearch = e => {\n    if (e.target.value.length > 3) {\n      axios\n        .get(`https://nominatim.openstreetmap.org/search.php?q=${e.target.value}&polygon_geojson=1&format=json&limit=5`)\n        .then(res => {\n          let cityResults = res.data.filter(function(el) {\n            if (el.geojson) {\n              return (\n                el.geojson.type === \"MultiPolygon\" ||\n                el.geojson.type === \"Polygon\"\n              );\n            } else {\n              return null; // avoid results not containing geojson.\n            } // only include search results that contain geojson polygons.\n          });\n          this.setState({ searchResults: cityResults });\n        });\n    } else if (e.target.value.length < 3) {\n      this.setState({\n        searchResults: [],\n      });\n    }\n  };\n\n  setFocus = (e) => {\n    if (e.type === 'mouseenter') {\n      this.setState({\n        focused: true\n      });\n    } else if (e.type === 'mouseleave') {\n      this.setState({\n        focused: false\n      });\n    }\n  }\n\n\n  toggleUI = (e) => {\n    if (e.type === 'blur' && this.state.focused === true) {\n      this.focusInput();\n    } else if (e.type === 'blur' && this.state.focused === false) {\n      this.setState({\n        searchStyle: {'display' : 'none'},\n        //style: { 'paddingBottom': '0px' }\n      });\n    } else if (e.type === 'focus') {\n      this.setState({\n        searchStyle: {'display' : 'block'}\n      });\n    }\n  }\n\n  focusInput = () => {\n    this.refs.searchbar.focus();\n  }\n\n  componentDidMount() {\n    this.focusInput();\n    // prevents form from refreshing page when hitting enter.\n    this.refs.searchbar.onkeypress = function(e) {\n      var key = e.charCode || e.keyCode || 0;\n      if (key === 13) {\n        e.preventDefault();\n      }\n    }\n  }\n\n  render() {\n\n    return (\n      <div onChange={this.handleSearch}\n           onClick={this.collapseSearch}\n           onMouseEnter={this.setFocus}\n           onMouseLeave={this.setFocus}\n           id=\"interface\">\n        <div id=\"searchBox\"\n           onMouseEnter={this.setFocus}\n           style={this.state.style}>\n          <input\n            ref='searchbar'\n            type=\"search\"\n            placeholder=\"Search locations, cities, countries, states...\"\n            onMouseEnter={this.setFocus}\n            onBlur={this.toggleUI}\n            onFocus={this.toggleUI}\n          />\n          <div id=\"searchIconContainer\">\n            <div id=\"searchIcon\"></div>\n          </div>\n          <div id=\"searchResults\" onMouseEnter={this.setFocus}  style={this.state.searchStyle}>\n            <SearchResult\n            onClick={this.focusInput}\n              returnResult={this.handleSearchResultClick}\n              searchResults={this.state.searchResults}\n            />\n          </div>\n        </div>\n      </div>\n    );\n  }\n}\n","import React from 'react';\nimport { Map as LeafletMap } from 'react-leaflet';\nimport L from 'leaflet';\nimport 'leaflet-truesize';\nimport MapboxLayer from \"./MapboxLayer.js\";\nimport getRandomColor from './functions/randomColor.js';\nimport MapUI from './MapUI.jsx';\n\n\nconst MAPBOX_ACCESS_TOKEN = \"pk.eyJ1IjoiZGJlbGxidHIiLCJhIjoiY2p5dTF5OXltMDFrOTNjbWxqdjZ5NmV2MCJ9.kkIqnzU12LF90W8yr-jsJw\";\nlet theCityItself = '';\n\nclass MapView extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      lat: 30.0,\n      lng: 0.0,\n      zoom: 3,\n      selectedCity: '',\n      focus: {}\n    }\n  };\n\n  componentDidMount() {\n\n  }\n\n  setCity = (city, name) => {\n    theCityItself = city; // usng a variabe is a few ms faster than setting state, wtf?\n    this.addCityLayer(city, name);\n  }\n\n  addCityLayer = (outline, name) => {\n    const mapInst = this.refs.map.leafletElement;\n    let boundaryColor = getRandomColor();\n    L.trueSize(outline, { // outlines[param].data\n      markerDiv: `<h2>${outline.name}</h2>`,\n      iconAnchor: [35, 35],\n      fill: true,\n      fillColor: boundaryColor[0],\n      fillOpacity: 0.15,\n      color: 'black',   //boundaryColor[1] is meant to be a\n      weight: 3,        //darker version of the same random\n      opacity: 1,       //color but black just looks nicer.\n      stroke: true,\n    }).addTo(mapInst);\n  }\n\n  handleClick = (e) => {\n    console.log(e.latlng);\n  }\n\n  render() {\n    const position = [this.state.lat, this.state.lng];\n    return (\n    <React.Fragment>\n      <LeafletMap center={position}\n                  zoom={this.state.zoom}\n                  zoomSnap='0.25'\n                  onClick={this.handleClick}\n                  ref='map' >\n        <MapboxLayer\n            accessToken={MAPBOX_ACCESS_TOKEN}\n            style=\"mapbox://styles/mapbox/light-v10\"\n          />\n      </LeafletMap>\n      <MapUI addOutline={this.setCity}  />\n      </React.Fragment>\n    );\n  }\n}\n\nexport default MapView\n","import React from 'react';\n//import logo from './logo.svg';\nimport './App.scss';\nimport MapView from './components/Map.jsx';\n\nfunction App() {\n  return (\n    <MapView />\n  );\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.scss';\nimport App from './App';\n//import * as serviceWorker from './serviceWorker';\n\nReactDOM.render(<App />, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\n//serviceWorker.unregister();\n"],"sourceRoot":""}